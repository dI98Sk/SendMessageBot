# –°–∏—Å—Ç–µ–º–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ broadcaster'–æ–≤

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö broadcaster'–æ–≤, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –≤ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —á–∞—Ç—ã.

## üéØ –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

1. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞**
   - –ù–µ—Å–∫–æ–ª—å–∫–æ broadcaster'–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω Telegram –∞–∫–∫–∞—É–Ω—Ç (acc1)
   - –ú–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —á–∞—Ç—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   - –†–∏—Å–∫ –ø–æ–ª—É—á–µ–Ω–∏—è FloodWait –æ—Ç Telegram

2. **–ü–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è —á–∞—Ç—ã**
   - –†–∞–∑–Ω—ã–µ broadcaster'—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —á–∞—Ç—ã
   - –ù—É–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫ –≤ –æ–¥–∏–Ω —á–∞—Ç

3. **–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞**
   - –ù–µ—Å–∫–æ–ª—å–∫–æ broadcaster'–æ–≤ –ø—ã—Ç–∞—é—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –æ–¥–∏–Ω —á–∞—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   - –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### 1. –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä (`core/coordinator.py`)

–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç:
- **–ì–ª–æ–±–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏** –≤ –∫–∞–∂–¥—ã–π —á–∞—Ç (–¥–ª—è –≤—Å–µ—Ö broadcaster'–æ–≤)
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —á–∞—Ç–æ–≤** (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏)
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é broadcaster'–æ–≤** –ø–æ –∞–∫–∫–∞—É–Ω—Ç–∞–º
- **–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —á–∞—Ç–æ–≤** –º–µ–∂–¥—É broadcaster'–∞–º–∏

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ broadcaster

–ö–∞–∂–¥—ã–π broadcaster:
- **–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è** –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–µ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
- **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- **–ü–æ–ª—É—á–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —á–∞—Ç–∞** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- **–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É** –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞

### 3. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è B2C

B2C broadcaster –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å:
- **–£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –º–µ–∂–¥—É —á–∞—Ç–∞–º–∏**: 120 —Å–µ–∫—É–Ω–¥ (2 –º–∏–Ω—É—Ç—ã)
- **–°–º–µ—â–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ —Å—Ç–∞—Ä—Ç–∞**: 300 —Å–µ–∫—É–Ω–¥ (5 –º–∏–Ω—É—Ç)
- **–î–ª–∏–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º**: 2 —á–∞—Å–∞

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ broadcaster'–æ–≤

### –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| Broadcaster | –ê–∫–∫–∞—É–Ω—Ç | –¶–∏–∫–ª | –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —á–∞—Ç–∞–º–∏ | –°–º–µ—â–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç–∞ |
|------------|---------|------|----------------------|-----------------|
| AAA_PRICE | acc2 | 20 –º–∏–Ω | 90—Å (–±–∞–∑–æ–≤–∞—è) | 0—Å |
| GUS_PRICE | acc1 | 20 –º–∏–Ω | 90—Å (–±–∞–∑–æ–≤–∞—è) | 0—Å |
| AAA_ADS | acc2 | 1 —á–∞—Å | 90—Å (–±–∞–∑–æ–≤–∞—è) | 0—Å |
| GUS_ADS | acc1 | 1 —á–∞—Å | 90—Å (–±–∞–∑–æ–≤–∞—è) | 0—Å |
| **GUS_B2C** | **acc1** | **2 —á–∞—Å–∞** | **120—Å (—É–≤–µ–ª–∏—á–µ–Ω–∞)** | **300—Å** |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

1. **–î–ª—è broadcaster'–æ–≤ —Å –¥–ª–∏–Ω–Ω—ã–º–∏ —Ü–∏–∫–ª–∞–º–∏** (B2C):
   - –£–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É —á–∞—Ç–∞–º–∏
   - –î–æ–±–∞–≤–∏—Ç—å —Å–º–µ—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å—Ç–∞—Ä—Ç–∞
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

2. **–î–ª—è broadcaster'–æ–≤ –æ–¥–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞**:
   - –†–∞–∑–¥–µ–ª–∏—Ç—å —á–∞—Ç—ã (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Å–º–µ—â–µ–Ω–∏—è —Å—Ç–∞—Ä—Ç–∞
   - –£–≤–µ–ª–∏—á–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–∞–º–∏

3. **–ü—Ä–∏ –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è —á–∞—Ç–∞—Ö**:
   - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏

## üìä –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è

### –ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞**
   ```python
   can_send, wait_time = await coordinator.can_send_to_chat(
       broadcaster_name, chat_id, min_interval
   )
   ```
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—Ä–æ—à–ª–æ –ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ —ç—Ç–æ—Ç —á–∞—Ç (–≥–ª–æ–±–∞–ª—å–Ω–æ)
   - –ï—Å–ª–∏ –Ω–µ—Ç - –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ

2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —á–∞—Ç–∞**
   ```python
   await coordinator.acquire_chat_lock(chat_id)
   ```
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –≤ –æ–¥–∏–Ω —á–∞—Ç
   - –î—Ä—É–≥–∏–µ broadcaster'—ã –±—É–¥—É—Ç –∂–¥–∞—Ç—å

3. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è**
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∫–∞
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞

4. **–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏**
   ```python
   coordinator.release_chat_lock(chat_id)
   ```
   - –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —á–∞—Ç –¥–ª—è –¥—Ä—É–≥–∏—Ö broadcaster'–æ–≤

5. **–ó–∞–ø–∏—Å—å –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä**
   ```python
   coordinator.record_send(broadcaster_name, chat_id)
   ```
   - –û–±–Ω–æ–≤–ª—è–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏

## üö® –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —á–∞—Ç–æ–≤ –∏ –≤—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:

```
‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: Broadcaster 'GUS_B2C_Broadcaster' –∏–º–µ–µ—Ç –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è —á–∞—Ç—ã:
   ‚Ä¢ –° 'GUS_PRICE_Broadcaster': 15 –æ–±—â–∏—Ö —á–∞—Ç–æ–≤
     –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: —É–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏ –∏–ª–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç—å —á–∞—Ç—ã
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —á–∞—Ç–æ–≤
- Broadcaster'—ã –ø–æ –∞–∫–∫–∞—É–Ω—Ç–∞–º
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Ç–æ–≤ —É –∫–∞–∂–¥–æ–≥–æ broadcaster'–∞
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–∞–º–∏

## üîÑ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —á–∞—Ç–æ–≤** (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ):
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Å–ø–∏—Å–∫–∏ —á–∞—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö broadcaster'–æ–≤
   - –ò–∑–±–µ–≥–∞—Ç—å –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π

2. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–µ–∫**:
   - –î–ª—è broadcaster'–æ–≤ —Å –¥–ª–∏–Ω–Ω—ã–º–∏ —Ü–∏–∫–ª–∞–º–∏
   - –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è —á–∞—Ç–æ–≤

3. **–°–º–µ—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å—Ç–∞—Ä—Ç–∞**:
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –≤–æ –≤—Ä–µ–º–µ–Ω–∏
   - –ò–∑–±–µ–∂–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –≤—Å–µ—Ö broadcaster'–æ–≤

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫**:
   - –°–ª–µ–¥–∏—Ç—å –∑–∞ FloodWait
   - –£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –æ—à–∏–±–∫–∞—Ö

## üõ† –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –Ω–æ–≤—ã—Ö broadcaster'–æ–≤

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ broadcaster'–∞:

```python
broadcaster = EnhancedBroadcaster(
    config=config,
    name="NEW_Broadcaster",
    targets=targets,
    messages=messages,
    session_name="sessions/acc1_new",
    cycle_delay=7200,  # 2 —á–∞—Å–∞
    delay_between_chats=120.0,  # 2 –º–∏–Ω—É—Ç—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ)
    start_offset_seconds=600  # 10 –º–∏–Ω—É—Ç —Å–º–µ—â–µ–Ω–∏–µ
)
```

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç broadcaster –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —á–∞—Ç–æ–≤
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é

