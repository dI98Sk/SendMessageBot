# üìä Google Sheets Updater Service

–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Google —Ç–∞–±–ª–∏—Ü.

---

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ Google —Ç–∞–±–ª–∏—Ü–∞—Ö, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö **Broadcaster Service** –±–µ—Ä–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- ‚úÖ –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Google —Ç–∞–±–ª–∏—Ü
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ retry –ª–æ–≥–∏–∫–∞

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements-updater.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.updater`:

```env
# Google Sheets
GOOGLE_CREDENTIALS_FILE=credentials.json

# –¢–∞–±–ª–∏—Ü—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
SHEET_URL_PRICE_AAA=https://docs.google.com/spreadsheets/d/...
SHEET_URL_PRICE_GUS=https://docs.google.com/spreadsheets/d/...
SHEET_URL_ADS_AAA=https://docs.google.com/spreadsheets/d/...
SHEET_URL_ADS_GUS=https://docs.google.com/spreadsheets/d/...

# –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Å–µ–∫—É–Ω–¥—ã)
UPDATE_INTERVAL=3600

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=INFO
LOG_FILE=logs/updater.log
```

### 3. –ó–∞–ø—É—Å–∫

```bash
python google_sheets_updater/main.py
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
google_sheets_updater/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ updater/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ sheet_updater.py   # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ data_sources.py    # –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ validators.py      # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ settings.py        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ sheets_config.py  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü
‚îî‚îÄ‚îÄ utils/
    ‚îî‚îÄ‚îÄ logger.py          # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

–°–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑:

- **API –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤** (REST, GraphQL)
- **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** (PostgreSQL, MySQL, MongoDB)
- **–§–∞–π–ª–æ–≤** (CSV, JSON, Excel)
- **–î—Ä—É–≥–∏—Ö Google —Ç–∞–±–ª–∏—Ü**

### –¶–µ–ª–µ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã

–¢–∞–±–ª–∏—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Ä–≤–∏—Å:

- –ü—Ä–∞–π—Å—ã AAA (`BUY_SELL_PRICE_AAA_SHEET_URL`)
- –ü—Ä–∞–π—Å—ã GUS (`BUY_SELL_PRICE_GUS_SHEET_URL`)
- –†–µ–∫–ª–∞–º–∞ AAA (`ADS_AAA_SHEET_URL`)
- –†–µ–∫–ª–∞–º–∞ GUS (`ADS_GUS_SHEET_URL`)

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. **–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è** –¥–∞–Ω–Ω—ã—Ö
3. **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
4. **–ó–∞–ø–∏—Å—å** –≤ Google —Ç–∞–±–ª–∏—Ü—É
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–∞–π–ª `logs/updater.log`:

```
2025-12-10 12:00:00 [INFO] updater: –ù–∞—á–∞–ª–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü
2025-12-10 12:00:05 [INFO] updater: –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –ü—Ä–∞–π—Å—ã AAA: 25 —Å—Ç—Ä–æ–∫
2025-12-10 12:00:10 [INFO] updater: –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –ü—Ä–∞–π—Å—ã GUS: 14 —Å—Ç—Ä–æ–∫
2025-12-10 12:00:15 [INFO] updater: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
```

---

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å –≤ `updater/data_sources.py`:

```python
class MyDataSource:
    def fetch_data(self) -> List[Dict]:
        # –õ–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        pass
```

2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –≤ `updater/sheet_updater.py`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã

1. –î–æ–±–∞–≤—å—Ç–µ URL –≤ `.env.updater`
2. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `config/sheets_config.py`
3. –û–±–Ω–æ–≤–∏—Ç–µ –ª–æ–≥–∏–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ `updater/sheet_updater.py`

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [MICROSERVICES_ARCHITECTURE.md](../docs/MICROSERVICES_ARCHITECTURE.md) - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
- [README.md](../README.md) - –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2025-12-10

